<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Portal Defensor√≠a Civil y Comercial 6</title>
  <style>
    * {box-sizing: border-box; margin: 0; padding: 0; font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;}
    body {height: 100vh; display: flex; flex-direction: column;}

    /* LOGIN MODERNO */
    #login-container {
      flex: 1;
      display: flex;
      height: 100vh;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      padding: 0;
      position: relative;
      overflow: hidden;
    }

    /* Fondo animado con burbujas */
    .background-animation {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      z-index: 1;
      overflow: hidden;
    }

    .bubble {
      position: absolute;
      background: rgba(255, 255, 255, 0.1);
      border-radius: 50%;
      animation: float 6s ease-in-out infinite;
    }

    .bubble:nth-child(1) {
      width: 80px;
      height: 80px;
      left: 10%;
      animation-delay: 0s;
    }

    .bubble:nth-child(2) {
      width: 120px;
      height: 120px;
      left: 20%;
      animation-delay: 2s;
    }

    .bubble:nth-child(3) {
      width: 60px;
      height: 60px;
      left: 35%;
      animation-delay: 4s;
    }

    .bubble:nth-child(4) {
      width: 100px;
      height: 100px;
      left: 50%;
      animation-delay: 1s;
    }

    .bubble:nth-child(5) {
      width: 90px;
      height: 90px;
      left: 70%;
      animation-delay: 3s;
    }

    .bubble:nth-child(6) {
      width: 70px;
      height: 70px;
      left: 85%;
      animation-delay: 5s;
    }

    @keyframes float {
      0%, 100% {
        transform: translateY(100vh) rotate(0deg);
        opacity: 0;
      }
      10%, 90% {
        opacity: 1;
      }
      50% {
        transform: translateY(-100px) rotate(180deg);
      }
    }

    .login-left {
      flex: 1;
      display: flex;
      justify-content: center;
      align-items: center;
      background: rgba(0, 0, 0, 0.3);
      backdrop-filter: blur(10px);
      z-index: 2;
      position: relative;
    }
    .login-left iframe {
      width: 90%;
      height: 80%;
      border: none;
      border-radius: 20px;
      box-shadow: 0 20px 40px rgba(0, 0, 0, 0.3);
    }

    .login-right {
      flex: 1;
      display: flex;
      justify-content: center;
      align-items: center;
      padding: 2rem;
      z-index: 2;
      position: relative;
    }

    #login-box {
      background: rgba(255, 255, 255, 0.95);
      backdrop-filter: blur(20px);
      border-radius: 20px;
      padding: 40px;
      box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
      width: 100%;
      max-width: 450px;
      text-align: center;
      border: 1px solid rgba(255, 255, 255, 0.2);
      transform: translateY(20px);
      opacity: 0;
      animation: slideIn 0.8s ease-out forwards;
    }

    @keyframes slideIn {
      to {
        transform: translateY(0);
        opacity: 1;
      }
    }

    #login-box h1 {
      font-size: 1.8rem;
      font-weight: 700;
      background: linear-gradient(135deg, #667eea, #764ba2);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
      margin-bottom: 10px;
      animation: titleGlow 2s ease-in-out infinite alternate;
    }

    @keyframes titleGlow {
      from {
        filter: drop-shadow(0 0 5px rgba(102, 126, 234, 0.3));
      }
      to {
        filter: drop-shadow(0 0 15px rgba(118, 75, 162, 0.5));
      }
    }

    #login-box h3 {
      font-size: 1rem;
      color: #666;
      margin-bottom: 1.5rem;
      font-weight: 400;
    }

    #login-box h2 {
      margin-bottom: 1.5rem;
      color: #333;
      font-size: 1.5rem;
      font-weight: 600;
    }

    .form-group {
      margin-bottom: 20px;
      position: relative;
    }

    #login-box input, #login-box select {
      width: 100%;
      padding: 15px 20px;
      border: 2px solid #e1e5e9;
      border-radius: 12px;
      font-size: 1rem;
      transition: all 0.3s ease;
      background: rgba(255, 255, 255, 0.8);
      outline: none;
      margin: 0;
    }

    #login-box input:focus, #login-box select:focus {
      border-color: #667eea;
      background: rgba(255, 255, 255, 1);
      transform: translateY(-2px);
      box-shadow: 0 10px 20px rgba(102, 126, 234, 0.1);
    }

    #login-box input::placeholder {
      color: #999;
      transition: all 0.3s ease;
    }

    #login-box input:focus::placeholder {
      transform: translateY(-20px);
      opacity: 0;
    }

    #login-box button {
      width: 100%;
      padding: 15px;
      background: linear-gradient(135deg, #667eea, #764ba2);
      color: white;
      border: none;
      border-radius: 12px;
      font-size: 1.1rem;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s ease;
      position: relative;
      overflow: hidden;
      margin-top: 10px;
    }

    #login-box button::before {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
      transition: left 0.5s;
    }

    #login-box button:hover::before {
      left: 100%;
    }

    #login-box button:hover {
      transform: translateY(-2px);
      box-shadow: 0 15px 30px rgba(102, 126, 234, 0.3);
    }

    #login-box button:active {
      transform: translateY(0);
    }

    /* Bot√≥n de registro */
    .register-section {
      margin-top: 20px;
      padding-top: 20px;
      border-top: 1px solid #e1e5e9;
    }

    .register-toggle {
      background: none;
      border: none;
      color: #667eea;
      cursor: pointer;
      font-size: 0.9rem;
      text-decoration: underline;
      transition: color 0.3s ease;
    }

    .register-toggle:hover {
      color: #764ba2;
    }

    #register-form {
      display: none;
      margin-top: 20px;
    }

    #register-form.show {
      display: block;
      animation: fadeIn 0.5s ease-out;
    }

    @keyframes fadeIn {
      from {
        opacity: 0;
        transform: translateY(10px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    #login-box p.notice {
      font-size: 0.85rem;
      color: #444;
      margin-top: 1.5rem;
      line-height: 1.5;
      background: rgba(241, 241, 241, 0.8);
      border: 1px solid rgba(204, 204, 204, 0.5);
      border-radius: 12px;
      padding: 1rem;
      backdrop-filter: blur(5px);
    }

    /* APP */
    #app {display: none; flex: 1; flex-direction: column; min-height: 100vh;}

    /* HEADER angosto */
    header {
      background: #0066cc;
      color: white;
      padding: 0.4rem 0.75rem;
      display: flex;
      align-items: center;
      gap: 0.75rem;
    }
    header h1 {font-size: 1.05rem; font-weight: 600;}

    .top-user-info {
      margin-left: auto;
      display: flex;
      align-items: center;
      gap: 0.5rem;
      min-width: 0;
    }
    .top-user-info .user-details {
      text-align: right;
      font-size: 0.85rem;
      line-height: 1;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
      max-width: 65vw;
    }
    .top-user-info .user-details strong {font-weight: 700;}
    .top-user-info button {
      background: #cc0000; color: white; font-weight: bold;
      border: none; border-radius: 6px; padding: 0.35rem 0.6rem;
      cursor: pointer; font-size: 0.8rem; flex: 0 0 auto;
    }
    .top-user-info button:hover {background: #990000;}

    .layout {display: flex; flex: 1;}
    .sidebar {
      display: flex; flex-direction: column;
      width: 220px; background: #0066cc; color: white;
      padding: 1rem 0.5rem; height: calc(100vh - 60px);
      transition: width 0.3s ease; cursor: pointer;
    }
    .sidebar.collapsed {width: 70px;}
    .sidebar h2 {font-size: 1rem; margin-bottom: 1rem; text-align: center; transition: opacity 0.3s;}
    .sidebar.collapsed h2 {opacity: 0;}
    .sidebar nav a {
      display: flex; align-items: center; gap: 10px;
      color: white; text-decoration: none;
      padding: 0.6rem; margin: 0.3rem;
      border-radius: 6px; background: rgba(255,255,255,0.1);
      transition: all 0.3s ease; white-space: nowrap; position: relative;
    }
    .sidebar nav a:hover {background: rgba(255,255,255,0.3);}
    .sidebar.collapsed nav a span {display: none;}
    .sidebar nav a::after {
      content: attr(data-title);
      position: absolute; left: 100%; top: 50%;
      transform: translateY(-50%);
      background: #333; color: #fff;
      padding: 4px 8px; border-radius: 4px;
      white-space: nowrap;
      opacity: 0; pointer-events: none;
      transition: opacity 0.2s; margin-left: 8px; font-size: 0.8rem;
    }
    .sidebar.collapsed nav a:hover::after {opacity: 1;}

    main {flex: 1; display: flex; position: relative;}
    iframe {flex: 1; border: none; background: white; min-height: 500px;}

    /* CHATBOT STYLES */
    #chatbot-toggle {
      position: fixed;
      bottom: 20px;
      right: 20px;
      width: 60px;
      height: 60px;
      background: #0066cc;
      border: none;
      border-radius: 50%;
      color: white;
      font-size: 24px;
      cursor: pointer;
      box-shadow: 0 4px 12px rgba(0,0,0,0.3);
      z-index: 1000;
      transition: all 0.3s ease;
      display: none;
    }

    #chatbot-toggle:hover {
      background: #004999;
      transform: scale(1.1);
    }

    #chatbot-container {
      position: fixed;
      bottom: 90px;
      right: 20px;
      width: 350px;
      height: 500px;
      background: white;
      border-radius: 12px;
      box-shadow: 0 8px 25px rgba(0,0,0,0.2);
      z-index: 1000;
      display: none;
      flex-direction: column;
      overflow: hidden;
    }

    #chatbot-header {
      background: #0066cc;
      color: white;
      padding: 15px;
      display: flex;
      align-items: center;
      justify-content: space-between;
    }

    #chatbot-header h3 {
      font-size: 1.1rem;
      font-weight: 600;
    }

    #chatbot-close {
      background: none;
      border: none;
      color: white;
      font-size: 20px;
      cursor: pointer;
      padding: 0;
      width: 25px;
      height: 25px;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    #chatbot-messages {
      flex: 1;
      padding: 15px;
      overflow-y: auto;
      background: #f8f9fa;
    }

    .message {
      margin-bottom: 15px;
      display: flex;
      align-items: flex-start;
      gap: 10px;
    }

    .message.bot {flex-direction: row;}
    .message.user {flex-direction: row-reverse;}

    .message-avatar {
      width: 35px;
      height: 35px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 16px;
      flex-shrink: 0;
    }

    .message.bot .message-avatar {background: #0066cc; color: white;}
    .message.user .message-avatar {background: #28a745; color: white;}

    .message-content {
      background: white;
      padding: 10px 15px;
      border-radius: 18px;
      max-width: 250px;
      word-wrap: break-word;
      box-shadow: 0 1px 3px rgba(0,0,0,0.1);
    }

    .message.user .message-content {background: #0066cc; color: white;}

    #chatbot-input-container {
      padding: 15px;
      background: white;
      border-top: 1px solid #e9ecef;
      display: flex;
      gap: 10px;
    }

    #chatbot-input {
      flex: 1;
      padding: 10px 15px;
      border: 1px solid #ddd;
      border-radius: 20px;
      outline: none;
      font-size: 14px;
    }

    #chatbot-send {
      background: #0066cc;
      color: white;
      border: none;
      border-radius: 50%;
      width: 40px;
      height: 40px;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 16px;
    }

    #chatbot-send:hover {background: #004999;}

    .quick-actions {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
      margin-top: 10px;
    }

    .quick-action {
      background: #e9ecef;
      border: 1px solid #ddd;
      border-radius: 15px;
      padding: 6px 12px;
      font-size: 12px;
      cursor: pointer;
      transition: all 0.2s ease;
    }

    .quick-action:hover {background: #0066cc; color: white;}

    /* RESPONSIVE OPTIMIZADO */
    @media (max-width: 1200px) {
      .login-right {
        flex: 1.2;
        padding: 1.5rem;
      }
      #login-box {
        max-width: 500px;
        padding: 35px;
      }
    }

    @media (max-width: 1024px) {
      #login-container {
        flex-direction: column;
        height: auto;
        min-height: 100vh;
      }
      .login-left, .login-right {
        flex: none;
        width: 100%;
        height: auto;
      }
      .login-left {
        min-height: 280px;
        padding: 15px;
        order: 1;
      }
      .login-left iframe {
        height: 250px;
        width: 95%;
      }
      .login-right {
        padding: 20px;
        order: 2;
        min-height: calc(100vh - 280px);
        display: flex;
        align-items: flex-start;
        justify-content: center;
        padding-top: 30px;
      }
      #login-box {
        max-width: 600px;
        width: 100%;
        margin: 0 auto;
        padding: 30px;
      }
    }

    @media (max-width: 768px) {
      .login-left {
        min-height: 220px;
        padding: 10px;
      }
      .login-left iframe {
        height: 200px;
        width: 98%;
      }
      .login-right {
        padding: 15px;
        padding-top: 20px;
        min-height: calc(100vh - 220px);
      }
      #login-box {
        padding: 25px 20px;
        border-radius: 15px;
        max-width: 100%;
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.15);
      }
      #login-box h1 {
        font-size: 1.6rem;
        line-height: 1.2;
      }
      #login-box h3 {
        font-size: 0.95rem;
        margin-bottom: 1.2rem;
      }
      .form-group {
        margin-bottom: 18px;
      }
      #login-box input, #login-box select {
        padding: 14px 18px;
        font-size: 0.95rem;
      }
    }

    @media (max-width: 600px) {
      .login-left {
        min-height: 180px;
      }
      .login-left iframe {
        height: 160px;
      }
      .login-right {
        padding: 10px;
        padding-top: 15px;
        min-height: calc(100vh - 180px);
      }
      #login-box {
        padding: 20px 15px;
        border-radius: 12px;
        margin: 0;
        max-height: none;
        overflow-y: auto;
      }
      #login-box h1 {
        font-size: 1.4rem;
        margin-bottom: 8px;
      }
      #login-box h3 {
        font-size: 0.9rem;
        margin-bottom: 1rem;
      }
      #login-box h2 {
        font-size: 1.3rem;
        margin-bottom: 1.2rem;
      }
      .form-group {
        margin-bottom: 15px;
      }
      #login-box input, #login-box select {
        padding: 12px 15px;
        font-size: 0.9rem;
      }
      #login-box button {
        padding: 12px;
        font-size: 1rem;
      }
      .register-section {
        margin-top: 15px;
        padding-top: 15px;
      }
      #login-box p.notice {
        font-size: 0.8rem;
        padding: 0.8rem;
        margin-top: 1rem;
      }
    }

    @media (max-width: 480px) {
      .login-left {
        min-height: 150px;
      }
      .login-left iframe {
        height: 130px;
      }
      .login-right {
        padding: 8px;
        padding-top: 12px;
        min-height: calc(100vh - 150px);
      }
      #login-box {
        padding: 18px 12px;
        border-radius: 10px;
      }
      #login-box h1 {
        font-size: 1.2rem;
        margin-bottom: 6px;
      }
      #login-box h3 {
        font-size: 0.85rem;
        margin-bottom: 0.8rem;
      }
      #login-box h2 {
        font-size: 1.2rem;
        margin-bottom: 1rem;
      }
      .form-group {
        margin-bottom: 12px;
      }
      #login-box input, #login-box select {
        padding: 10px 12px;
        font-size: 0.85rem;
      }
      #login-box button {
        padding: 10px;
        font-size: 0.95rem;
      }
      .register-toggle {
        font-size: 0.85rem;
      }
      #login-box p.notice {
        font-size: 0.75rem;
        padding: 0.7rem;
        line-height: 1.4;
      }
    }

    @media (max-width: 360px) {
      .login-right {
        padding: 5px;
        padding-top: 10px;
      }
      #login-box {
        padding: 15px 10px;
        border-radius: 8px;
      }
      #login-box h1 {
        font-size: 1.1rem;
      }
      #login-box h3 {
        font-size: 0.8rem;
      }
      #login-box h2 {
        font-size: 1.1rem;
      }
      #login-box input, #login-box select {
        padding: 8px 10px;
        font-size: 0.8rem;
      }
      #login-box button {
        padding: 8px;
        font-size: 0.9rem;
      }
    }

    /* Animaci√≥n de carga */
    .loading {
      display: none;
      width: 20px;
      height: 20px;
      border: 2px solid rgba(255, 255, 255, 0.3);
      border-radius: 50%;
      border-top-color: white;
      animation: spin 1s ease-in-out infinite;
      margin-right: 10px;
    }

    @keyframes spin {
      to {
        transform: rotate(360deg);
      }
    }

    .login-button.loading .loading {
      display: inline-block;
    }

    .login-button.loading .button-text {
      opacity: 0.7;
    }
  </style>
</head>
<body>
  <!-- LOGIN -->
  <div id="login-container">
    <!-- Fondo animado -->
    <div class="background-animation">
      <div class="bubble"></div>
      <div class="bubble"></div>
      <div class="bubble"></div>
      <div class="bubble"></div>
      <div class="bubble"></div>
      <div class="bubble"></div>
    </div>

    <div class="login-left">
      <iframe
        width="100%"
        height="100%"
        src="https://www.youtube.com/embed/mOsk64DvzFc"
        title="Video Institucional"
        frameborder="0"
        allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share"
        allowfullscreen
        referrerpolicy="strict-origin-when-cross-origin"
        loading="lazy">
      </iframe>
    </div>
    <div class="login-right">
      <div id="login-box">
        <h1>Sistema de Administraci√≥n de Causas Judiciales</h1>
        <h3>Defensor√≠a Civil y Comercial 6 - Poder Judicial de Misiones</h3>
        <h2>Iniciar Sesi√≥n</h2>
        
        <!-- Formulario de Login -->
        <form id="login-form" onsubmit="event.preventDefault(); login();">
          <div class="form-group">
            <input type="text" id="username" placeholder="Usuario (Nombre Apellido)" required>
          </div>
          <div class="form-group">
            <input type="email" id="email" placeholder="Email" required>
          </div>
          <div class="form-group">
            <select id="role" required>
              <option value="">Seleccione rol de usuario</option>
              <option value="Administrador">Administrador</option>
              <option value="Defensor">Defensor</option>
              <option value="Secretario">Secretario</option>
              <option value="Empleado">Empleado</option>
            </select>
          </div>
          <div class="form-group">
            <input type="password" id="password" placeholder="Contrase√±a" required>
          </div>
          <button type="submit" class="login-button">
            <div class="loading"></div>
            <span class="button-text">Entrar</span>
          </button>
        </form>

        <!-- Secci√≥n de Registro -->
        <div class="register-section">
          <button type="button" class="register-toggle" onclick="toggleRegister()">
            ¬øNo tienes cuenta? Reg√≠strate aqu√≠
          </button>
          
          <form id="register-form" onsubmit="event.preventDefault(); register();">
            <h3 style="margin-bottom: 15px; color: #333;">Crear Nueva Cuenta</h3>
            <div class="form-group">
              <input type="text" id="reg-username" placeholder="Nombre Completo" required>
            </div>
            <div class="form-group">
              <input type="email" id="reg-email" placeholder="Email" required>
            </div>
            <div class="form-group">
              <select id="reg-role" required>
                <option value="">Seleccione rol de usuario</option>
                <option value="Usuario">Usuario</option>
                <option value="Empleado">Empleado</option>
                <option value="Secretario">Secretario</option>
              </select>
            </div>
            <div class="form-group">
              <input type="password" id="reg-password" placeholder="Contrase√±a" required>
            </div>
            <div class="form-group">
              <input type="password" id="reg-confirm-password" placeholder="Confirmar Contrase√±a" required>
            </div>
            <button type="submit" class="login-button">
              <div class="loading"></div>
              <span class="button-text">Registrarse</span>
            </button>
            <button type="button" class="register-toggle" onclick="toggleRegister()" style="margin-top: 10px;">
              ¬øYa tienes cuenta? Inicia sesi√≥n
            </button>
          </form>
        </div>

        <p class="notice">
          En caso de alg√∫n inconveniente, problema de funcionalidad, dudas o consultas sobre el sistema:<br>
          Comun√≠quese al email:
          <a href="https://correo.jusmisiones.gov.ar/#1" target="_blank">rcfioravante@jusmisiones.gov.ar</a><br><br>
          Incluya en el mensaje los siguientes datos: Nombre y Apellido, Email y Rol de Usuario registrado en el sistema.<br>
          En breve estaremos en contacto.
        <h3>Uso exclusivo con acceso remoto</h3>
        </p>
      </div>
    </div>
  </div>

  <!-- APP -->
  <div id="app">
    <header>
      <h1 id="active-section">Portal Defensor√≠a</h1>
      <div class="top-user-info">
        <div class="user-details" id="user-info" title=""></div>
        <button onclick="logout()">Cerrar Sesi√≥n</button>
      </div>
    </header>
    <div class="layout">
      <div class="sidebar" id="sidebar">
        <h2>Men√∫</h2>
        <nav>
          <a href="#" onclick="loadPage('https://defensoria6.github.io/registro-causas/', this)" data-title="Registro Causas">üìë <span>Registro Causas</span></a>
          <a href="#" onclick="loadPage('https://defensoria6.github.io/datospartes/', this)" data-title="Datos Partes">üë• <span>Datos Partes</span></a>
          <a href="#" onclick="loadPage('https://defensoria6.github.io/proteccion-personas/', this)" data-title="Protecci√≥n Personas">üõ°Ô∏è <span>Protecci√≥n Personas</span></a>
          <a href="#" onclick="loadPage('https://defensoria6.github.io/calendario/', this)" data-title="Calendario">üìÖ <span>Calendario</span></a>
          <a href="#" onclick="loadPage('https://defensoria6.github.io/estadistica-sistema/', this)" data-title="Estad√≠stica">üìä <span>Estad√≠stica</span></a>
          <a href="#" onclick="loadPage('https://defensoria6.github.io/atencion-publico/', this)" data-title="Atenci√≥n P√∫blico">üí¨ <span>Atenci√≥n P√∫blico</span></a>
          <a href="#" onclick="loadPage('https://defensoria6.github.io/documentos/', this)" data-title="Documentos">üìÑ <span>Documentos</span></a>
        </nav>
      </div>
      <main>
        <iframe id="content-frame" src="https://defensoria6.github.io/registro-causas/"></iframe>
      </main>
    </div>

    <!-- CHATBOT -->
    <button id="chatbot-toggle" onclick="toggleChatbot()">üí¨</button>

    <div id="chatbot-container">
      <div id="chatbot-header">
        <h3>üí¨ Asistente SeisBot</h3>
        <button id="chatbot-close" onclick="toggleChatbot()">√ó</button>
      </div>

      <div id="chatbot-messages"></div>

      <div id="chatbot-input-container">
        <input type="text" id="chatbot-input" placeholder="Escribe tu consulta..." onkeypress="handleChatbotKeyPress(event)">
        <button id="chatbot-send" onclick="sendMessage()">‚û§</button>
      </div>
    </div>
  </div>

  <script>
    let chatbotOpen = false;
    let currentUser = '';
    let isRegisterMode = false;

    function toggleRegister() {
      isRegisterMode = !isRegisterMode;
      const loginForm = document.getElementById('login-form');
      const registerForm = document.getElementById('register-form');
      
      if (isRegisterMode) {
        loginForm.style.display = 'none';
        registerForm.classList.add('show');
      } else {
        loginForm.style.display = 'block';
        registerForm.classList.remove('show');
      }
    }

    function register() {
      const button = document.querySelector('#register-form .login-button');
      const buttonText = button.querySelector('.button-text');
      
      // Mostrar estado de carga
      button.classList.add('loading');
      buttonText.textContent = 'Registrando...';
      
      const user = document.getElementById('reg-username').value.trim();
      const email = document.getElementById('reg-email').value.trim();
      const role = document.getElementById('reg-role').value.trim();
      const pass = document.getElementById('reg-password').value.trim();
      const confirmPass = document.getElementById('reg-confirm-password').value.trim();
      
      setTimeout(() => {
        button.classList.remove('loading');
        buttonText.textContent = 'Registrarse';
        
        if (!user || !email || !role || !pass || !confirmPass) {
          alert('Complete todos los campos para el registro');
          return;
        }
        
        if (pass !== confirmPass) {
          alert('Las contrase√±as no coinciden');
          return;
        }
        
        if (pass.length < 6) {
          alert('La contrase√±a debe tener al menos 6 caracteres');
          return;
        }
        
        // Simular registro exitoso
        alert('¬°Registro exitoso! Ahora puede iniciar sesi√≥n con sus credenciales.');
        
        // Limpiar formulario de registro
        document.getElementById('reg-username').value = '';
        document.getElementById('reg-email').value = '';
        document.getElementById('reg-role').value = '';
        document.getElementById('reg-password').value = '';
        document.getElementById('reg-confirm-password').value = '';
        
        // Volver al formulario de login
        toggleRegister();
        
        // Pre-llenar datos en el login
        document.getElementById('username').value = user;
        document.getElementById('email').value = email;
        document.getElementById('role').value = role;
      }, 1500);
    }

    function login(){
      const button = document.querySelector('#login-form .login-button');
      const buttonText = button.querySelector('.button-text');
      
      // Mostrar estado de carga
      button.classList.add('loading');
      buttonText.textContent = 'Iniciando sesi√≥n...';
      
      const user = document.getElementById('username').value.trim();
      const email = document.getElementById('email').value.trim();
      const role = document.getElementById('role').value.trim();
      const pass = document.getElementById('password').value.trim();
      
      setTimeout(() => {
        button.classList.remove('loading');
        buttonText.textContent = 'Entrar';
        
        if(user && email && role && pass){
          currentUser = user;
          document.getElementById('login-container').style.display = 'none';
          document.getElementById('app').style.display = 'flex';
          const line = "<strong>" + user + "</strong> ‚Äî " + email + " ‚Äî <strong>Rol: " + role + "</strong>";
          const info = document.getElementById('user-info');
          info.innerHTML = line;
          info.setAttribute('title', user + " | " + email + " | Rol: " + role);
          document.getElementById('active-section').innerText = "Registro Causas";

          // Mostrar el chatbot despu√©s del login
          document.getElementById('chatbot-toggle').style.display = 'block';

          // Inicializar el chatbot con mensaje de bienvenida
          setTimeout(() => {
            initializeChatbot();
          }, 1000);
        } else {
          alert('Complete todos los campos: usuario, email, rol y contrase√±a');
        }
      }, 1500);
    }

    function logout(){
      document.getElementById('app').style.display = 'none';
      document.getElementById('login-container').style.display = 'flex';
      document.getElementById('username').value =
      document.getElementById('email').value =
      document.getElementById('role').value =
      document.getElementById('password').value = '';

      // Ocultar el chatbot
      document.getElementById('chatbot-toggle').style.display = 'none';
      document.getElementById('chatbot-container').style.display = 'none';
      chatbotOpen = false;

      // Limpiar mensajes del chatbot
      document.getElementById('chatbot-messages').innerHTML = '';
      
      // Volver al modo login si estaba en registro
      if (isRegisterMode) {
        toggleRegister();
      }
    }

    function loadPage(url, element){
      const iframe = document.getElementById('content-frame');
      iframe.src = url;
      if(element) document.getElementById('active-section').innerText = element.getAttribute("data-title");
    }

    document.getElementById('sidebar').addEventListener('click', function(e) {
      if(e.target.tagName !== "A") this.classList.toggle('collapsed');
    });

    // --- CHATBOT ---
    function toggleChatbot() {
      chatbotOpen = !chatbotOpen;
      const container = document.getElementById('chatbot-container');
      container.style.display = chatbotOpen ? 'flex' : 'none';

      if (chatbotOpen && document.getElementById('chatbot-messages').children.length === 0) {
        initializeChatbot();
      }
    }

    function initializeChatbot() {
      const welcomeMessage = `¬°Hola ${currentUser}! üëã Soy SeisBot, tu asistente virtual del Sistema de Defensor√≠a Civil y Comercial 6.

Estoy aqu√≠ para ayudarte con:

üîç <b>B√∫squeda de datos</b> en causas, partes y medidas de protecci√≥n
üìÇ <b>Navegaci√≥n por secciones</b> del portal
üìÖ <b>Audiencias y calendario</b>
üìä <b>Estad√≠sticas del sistema</b>
üí¨ <b>Atenci√≥n al p√∫blico</b>

¬øEn qu√© puedo ayudarte hoy?`;

      addMessage('bot', welcomeMessage);
      
      // Agregar acciones r√°pidas
      const quickActions = [
        'Buscar causa',
        'Ver calendario',
        'Estad√≠sticas',
        'Ayuda navegaci√≥n'
      ];
      
      addQuickActions(quickActions);
    }

    function addMessage(sender, message) {
      const messagesContainer = document.getElementById('chatbot-messages');
      const messageDiv = document.createElement('div');
      messageDiv.className = `message ${sender}`;
      
      const avatar = document.createElement('div');
      avatar.className = 'message-avatar';
      avatar.textContent = sender === 'bot' ? 'ü§ñ' : 'üë§';
      
      const content = document.createElement('div');
      content.className = 'message-content';
      content.innerHTML = message;
      
      messageDiv.appendChild(avatar);
      messageDiv.appendChild(content);
      messagesContainer.appendChild(messageDiv);
      messagesContainer.scrollTop = messagesContainer.scrollHeight;
    }

    function addQuickActions(actions) {
      const messagesContainer = document.getElementById('chatbot-messages');
      const actionsDiv = document.createElement('div');
      actionsDiv.className = 'quick-actions';
      
      actions.forEach(action => {
        const button = document.createElement('button');
        button.className = 'quick-action';
        button.textContent = action;
        button.onclick = () => handleQuickAction(action);
        actionsDiv.appendChild(button);
      });
      
      messagesContainer.appendChild(actionsDiv);
      messagesContainer.scrollTop = messagesContainer.scrollHeight;
    }

    function handleQuickAction(action) {
      addMessage('user', action);
      
      setTimeout(() => {
        let response = '';
        switch(action) {
          case 'Buscar causa':
            response = 'Para buscar una causa, ve a la secci√≥n "Registro Causas" en el men√∫ lateral. All√≠ podr√°s filtrar por n√∫mero de expediente, partes involucradas o fecha.';
            break;
          case 'Ver calendario':
            response = 'El calendario muestra todas las audiencias programadas. Haz clic en "Calendario" en el men√∫ lateral para acceder.';
            break;
          case 'Estad√≠sticas':
            response = 'En la secci√≥n "Estad√≠stica" encontrar√°s reportes detallados sobre el rendimiento del sistema y m√©tricas de casos.';
            break;
          case 'Ayuda navegaci√≥n':
            response = 'Usa el men√∫ lateral para navegar entre secciones. Puedes colapsar el men√∫ haciendo clic en √©l. Cada secci√≥n tiene herramientas espec√≠ficas para tu trabajo.';
            break;
          default:
            response = 'Gracias por tu consulta. ¬øHay algo m√°s en lo que pueda ayudarte?';
        }
        addMessage('bot', response);
      }, 1000);
    }

    function sendMessage() {
      const input = document.getElementById('chatbot-input');
      const message = input.value.trim();
      
      if (message) {
        addMessage('user', message);
        input.value = '';
        
        // Simular respuesta del bot
        setTimeout(() => {
          const responses = [
            'Entiendo tu consulta. Te ayudo a encontrar la informaci√≥n que necesitas.',
            'Perfecto, d√©jame buscar esa informaci√≥n en el sistema.',
            'Excelente pregunta. Aqu√≠ tienes la informaci√≥n solicitada.',
            'Claro, puedo ayudarte con eso. ¬øNecesitas algo m√°s espec√≠fico?'
          ];
          const randomResponse = responses[Math.floor(Math.random() * responses.length)];
          addMessage('bot', randomResponse);
        }, 1000);
      }
    }

    function handleChatbotKeyPress(event) {
      if (event.key === 'Enter') {
        sendMessage();
      }
    }

    // Animaci√≥n de entrada para los elementos del formulario
    window.addEventListener('load', function() {
      const formGroups = document.querySelectorAll('.form-group');
      formGroups.forEach((group, index) => {
        setTimeout(() => {
          group.style.opacity = '0';
          group.style.transform = 'translateX(-20px)';
          group.style.transition = 'all 0.5s ease';
          
          setTimeout(() => {
            group.style.opacity = '1';
            group.style.transform = 'translateX(0)';
          }, 100);
        }, index * 200);
      });
    });

    // Efecto de part√≠culas en el cursor (opcional)
    document.addEventListener('mousemove', function(e) {
      if (Math.random() > 0.95) {
        createParticle(e.clientX, e.clientY);
      }
    });

    function createParticle(x, y) {
      const particle = document.createElement('div');
      particle.style.position = 'fixed';
      particle.style.left = x + 'px';
      particle.style.top = y + 'px';
      particle.style.width = '4px';
      particle.style.height = '4px';
      particle.style.background = 'rgba(102, 126, 234, 0.6)';
      particle.style.borderRadius = '50%';
      particle.style.pointerEvents = 'none';
      particle.style.zIndex = '1000';
      particle.style.animation = 'particleFade 1s ease-out forwards';
      
      document.body.appendChild(particle);
      
      setTimeout(() => {
        particle.remove();
      }, 1000);
    }

    // Agregar keyframes para las part√≠culas
    const style = document.createElement('style');
    style.textContent = `
      @keyframes particleFade {
        0% {
          opacity: 1;
          transform: translateY(0) scale(1);
        }
        100% {
          opacity: 0;
          transform: translateY(-50px) scale(0);
        }
      }
    `;
    document.head.appendChild(style);
  </script>
</body>
</html>
